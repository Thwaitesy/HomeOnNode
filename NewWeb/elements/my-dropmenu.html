<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-menu/core-menu.html">
<link rel="import" href="../bower_components/paper-elements/paper-elements.html">

<polymer-element name="my-dropmenu" attributes="device modifiers state" flex>
  <template>
    <style>
      :host {
        background-color: white;
        padding: 0px;
        min-width: 85px;
        font-size: 0.80rem;
        font-weight: 300;
        margin: 5px;
      }

      paper-button[raised] {
        background: #4285f4;
        color: #fff;
      }
      .lsButton {
        text-align: left;
        text-transform: none;
        margin: 0;
        width: 100%;
        height: 100%;
      }
      paper-menu-button {
        border-left: 1px solid #efefef;
        height: 100%;
      }
      @media screen and (min-width: 500px) {
        :host {
          font-size: 0.80em;
          min-width: 110px;
        }
      }
      @media screen and (min-width: 650px) {
        :host {
          font-size: 0.85em;
          min-width: 130px;
        }
      }
      @media screen and (min-width: 800px) {
        :host {
          font-size: 1.2em;
          min-width: 175px;
        }
      }
    </style>
    <div horizontal layout justified>
      <paper-button raised?="{{state==device.command}}" class="lsButton" on-tap="{{buttap}}" noink horizontal layout left-justified>
        <content></content>
      </paper-button>

      <paper-menu-button hidden?="{{!modifiers}}">
        <paper-icon-button icon="arrow-drop-down" noink></paper-icon-button>
        <paper-dropdown class="dropdown">
          <template repeat="{{modifier in modifiers}}">
            <paper-item on-tap="{{itemTap}}">{{modifier.label}}</paper-item>
          </template>
        </paper-dropdown>
      </paper-menu-button>
    </div>
  </template>
  <script type="text/javascript">
    Polymer({
      ready: function() {
        // console.log("ST", this.state)
      },
      buttap: function(event, detail, sender) {
        this.sendCommand(null);
      },
      itemTap: function(event, detail, sender) {
        this.sendCommand(sender.templateInstance.model.modifier.command);
      },
      sendCommand: function(modifier) {
        var cmd = {
          "command": this.device.command,
          "modifier": modifier
        };
        fb.child("commands").push(cmd);
        console.log("commandPressed", cmd);
      }
    });


  </script>
</polymer-element>