<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-icons/core-icons.html">

<polymer-element name="error-list">

  <template>
    <link rel="stylesheet" type="text/css" href="/styles/main.css">
    <style type="text/css">
      ul {
        padding-left: 0;
        list-style-type: none;
        margin-top: 0;
      }
      li {
        border-bottom: 1px solid #b6b6b6;
        min-height: 48px;
        padding: 0 16px;
        vertical-align: middle;
      }
      .circle {
        width: 16px;
        height: 16px;
        background-color: red;
        display: inline-block;
        border-radius: 50%;
      }
      .red {
        color: #B71C1C;
      }
      .yellow {
        color: #FFC107;
      }
    </style>

    <ul vertical layout class="text-medium">
      <template repeat="{{item in items}}">
        <li horizontal layout center on-tap="{{onTap}}">
          <span flex>
            <template if="{{item.exception}}">
              <core-icon class="red" icon="error"></core-icon>
            </template>
            <template if="{{!item.exception}}">
              <core-icon class="yellow" icon="warning"></core-icon>
            </template>
            {{item.date | toDateTime }}
          </span>
          <span flex three>{{item.message}}</span>
        </li>
      </template>
    </ul>
  </template>
  <script type="text/javascript">
    Polymer({
      created: function() {
        this.items = [];
      },
      ready: function() {
        var self = this;
        fb.child("logs/errors").limitToLast(50).on("child_added", function(snapshot) {
          self.items.unshift(snapshot.val());
        });
      },
      toDateTime: function(value) {
        if (value) {
          return moment(value).format("M/D/YY, h:mm:ss a");
        } else {
          return "";
        }
      },
      onTap: function(event, details, sender) {
        //console.log("TAP");
      }
    });
  </script>
</polymer-element>
