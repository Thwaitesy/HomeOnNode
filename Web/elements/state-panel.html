<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../bower_components/paper-dropdown/paper-dropdown.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/core-menu/core-menu.html">

<polymer-element name="state-panel" attributes="state devices">
  <template>
    <link no-shim href="/styles/pbutton.css" rel="stylesheet">
    <div layout start-justified wrap horizontal>
      <template repeat="{{devices as device}}">
        <template if="{{device.kind=='state'}}">
          <paper-button class="small" colored?="{{state==device.command}}" on-tap="{{setState}}" device="{{device}}" flex>
            {{device.label}}
          </paper-button>
        </template>
      </template>
    </div>
  </template>
  <script type="text/javascript">
    Polymer({
      created: function() {
        this.state = undefined;
      },
      setState: function(event, details, sender) {
        var newState = sender.templateInstance.model.device.command;
        console.log("setState", newState);
        window.lastEvent = Date.now();
        fb.child("commands").push({"command": newState});
      }
    });
  </script>
</polymer-element>