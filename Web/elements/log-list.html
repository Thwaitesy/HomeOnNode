<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-list/core-list.html">


<polymer-element name="log-list" attributes="path">

  <template>
    <link rel="stylesheet" type="text/css" href="/styles/main.css">
    <style type="text/css">
      ul {
        padding-left: 0;
        list-style-type: none;
        margin-top: 0;
      }
      li {
        border-bottom: 1px solid #b6b6b6;
        min-height: 48px;
        padding: 0 16px;
      }
      .label {
        display: inline-block;
        border-radius: 4px;
        background-color: #9e9e9e;
        text-transform: capitalize;
        padding: 0.3em 0.6em;
        font-size: 0.8em;
      }

      .ARMED {
        background-color: #ffcdd2;
        color: #000000;
      }

      .OPEN, .AWAY {
        background-color: #f44336;
        color: #ffffff;
      }

      .CLOSED, .HOME, .PRESENT {
        background-color: #2196f3;
        color: #ffffff;
      }

      .SLEEP {
        background-color: #bbdefb;
        color: #000000;
      }

    </style>

    <ul vertical layout class="text-medium">
      <template repeat="{{item in items}}">
        <li horizontal layout center>
          <template if="{{item.name}}">
            <span flex two>{{item.name}}</span>
          </template>
          <template if="{{item.lastSeen}}">
            <span flex>{{item.lastSeen | toDateTime }}</span>
          </template>
          <template if="{{item.date}}">
            <span flex>{{item.date | toDateTime }}</span>
          </template>
          <span flex horizontal end-justified layout>
            <span class="label {{item.state}}">{{item.state}}</span>
          </span>

        </li>
      </template>
    </ul>
  </template>
  <script type="text/javascript">
    Polymer({
      created: function() {
        this.items = [];
      },
      ready: function() {
        var self = this;
        fb.child(this.path).limitToLast(125).on("child_added", function(snapshot) {
          self.items.unshift(snapshot.val());
        });
      },
      toDateTime: function(value) {
        if (value) {
          return moment(value).format("M/D/YY, h:mm:ss a");
        } else {
          return "";
        }
      }
    });
  </script>
</polymer-element>
